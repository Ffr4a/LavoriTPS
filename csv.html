<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>
    <style>
         body{
            background-image:url(backCSV.jpg);
            background-size: cover;
            background-attachment: fixed;
        }
    </style>
    <script>
        function readfile(input){
            let file=input.files[0];
            let fileReader= new FileReader();
            
            fileReader.onload=function(lettura){
                let tab=document.getElementById("tabella");
                var risultato=lettura.target.result;
                let contenitore=risultato.split('\n');
                for(var i=0;i<contenitore.length;i++){
                    var row=document.createElement("tr");
                    var riga=contenitore[i].split(',');
                    for(var j=0;j<riga.length;j++){
                        var element=document.createElement("td");
                        element.textContent=riga[j];
                        row.appendChild(element);
                    }
                    tab.appendChild(row);
                }
                aggiungiPulsante();
            }
            fileReader.readAsText(file);
        }

        function aggiungiPulsante(){
        var pulsante = document.createElement("button");
        pulsante.textContent = "Genera grafici";
        pulsante.onclick = crea;
        document.getElementById("btn").appendChild(pulsante);}

        
        src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        
        
    </script>
    <script>
        function crea(){
        var xValues =[document.getElementById(("tabella")).rows[1].cells[1].innerText,document.getElementById(("tabella")).rows[2].cells[1].innerText,document.getElementById(("tabella")).rows[3].cells[1].innerText, document.getElementById(("tabella")).rows[4].cells[1].innerText, document.getElementById(("tabella")).rows[5].cells[1].innerText,document.getElementById(("tabella")).rows[6].cells[1].innerText,document.getElementById(("tabella")).rows[7].cells[1].innerText,document.getElementById(("tabella")).rows[8].cells[1].innerText];
        var yValues = [parseInt(document.getElementById(("tabella")).rows[1].cells[2].innerText), parseInt(document.getElementById(("tabella")).rows[2].cells[2].innerText), parseInt(document.getElementById(("tabella")).rows[3].cells[2].innerText), parseInt(document.getElementById(("tabella")).rows[4].cells[2].innerText), parseInt(document.getElementById(("tabella")).rows[5].cells[2].innerText),parseInt(document.getElementById(("tabella")).rows[6].cells[2].innerText),parseInt(document.getElementById(("tabella")).rows[7].cells[2].innerText),parseInt(document.getElementById(("tabella")).rows[8].cells[2].innerText)];
        var barColors = ["red", "green","blue","orange","brown","yellow","purple","grey"];
        
        new Chart("myChart", {
          type: "bar",
          data: {
            labels: xValues,
            datasets: [{
              backgroundColor: barColors,
              data: yValues
            }]
          },
          options: {
            legend: {display: false},
            title: {
              display: true,
              text: "Età lavoratori"
            }
          }
        });
        
        var xValue = [document.getElementById(("tabella")).rows[1].cells[1].innerText,document.getElementById(("tabella")).rows[2].cells[1].innerText,document.getElementById(("tabella")).rows[3].cells[1].innerText, document.getElementById(("tabella")).rows[4].cells[1].innerText, document.getElementById(("tabella")).rows[5].cells[1].innerText,document.getElementById(("tabella")).rows[6].cells[1].innerText,document.getElementById(("tabella")).rows[7].cells[1].innerText,document.getElementById(("tabella")).rows[8].cells[1].innerText];
        var yValues = [parseInt(document.getElementById(("tabella")).rows[1].cells[4].innerText), parseInt(document.getElementById(("tabella")).rows[2].cells[4].innerText), parseInt(document.getElementById(("tabella")).rows[3].cells[4].innerText), parseInt(document.getElementById(("tabella")).rows[4].cells[4].innerText), parseInt(document.getElementById(("tabella")).rows[5].cells[4].innerText),parseInt(document.getElementById(("tabella")).rows[6].cells[4].innerText),parseInt(document.getElementById(("tabella")).rows[7].cells[4].innerText),parseInt(document.getElementById(("tabella")).rows[8].cells[4].innerText)];
        var barColors = [
        "red",
        "green",
        "blue",
        "orange",
        "brown",
        "yellow",
        "purple",
        "grey"
        ];

        new Chart("myPie", {
            type: "pie",
            data: {
                labels: xValues,
                datasets: [{
                backgroundColor: barColors,
                data: yValues
                }]
            },
            options: {
                title: {
                display: true,
                text: "Stipendio lavoratori"
                }
            }
            });
    
    
    }
        </script>
</head>
<body>
    <center>
    <h1 style="color: darkred; font-size: 100px; font-weight: bold;">Lettura file CSV</h1>
    <input type="file" id="input" onchange="readfile(this)" style="font-size: 35px; padding-top: 90px;" accept=".csv">
    <p style="font-weight: bold; color: darkgray; font-size: 20px; padding-top: 60px;">Il contenuto del file verrà stampato di seguito:</p>
    <div style=  "font-size: large; padding-top: 70px;">
    
    <table class="table" id="tabella" style="color: aliceblue; font-weight:bold; background-color: black;">
       
    </table>
    <div id="btn"></div>
    </div>
    
    
    <canvas id="myChart" style="width:100%;max-width:600px"></canvas>
    <p>   </p>
    <canvas id="myPie" style="width:100%;max-width:600px"></canvas>
    <p>  </p>
</center>
    
</body>
</html>
